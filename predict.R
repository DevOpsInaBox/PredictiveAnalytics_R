options( warn = -1 )

temp = list.files(pattern="release.*")

for (i in 1:length(temp))
{
  assign(paste0("release",i), read.csv(temp[i]))
}

par(mfrow=c(2,2),cex.lab=0.7,cex.main=0.7)

for(i in 1:30)
{
  release<-get(paste0("release",i))
  input = readline(paste('Press Enter to view "Defect Age" Plot for release',i))
  plot(release$numActive,release$Total.num.days,main=paste0("Total Num of Days Vs. Number of times Active\n Release",i),xlab='Number of times Active',ylab='Total Num of Days')
  plot(release$numDaysActive,release$Total.num.days,main=paste0("Total Num of Days  Vs.  Number of days Active\n Release",i),xlab='Number of days Active',ylab='Total Num of Days')
  plot(release$numReopened,release$Total.num.days,main=paste0("Total Num of Days  Vs.  Number of times Reopened\n Release",i),xlab='Number of times Reopened',ylab='Total Num of Days')
  plot(release$LOC,release$Total.num.days,main=paste0("Total Num of Days  Vs. Lines of Code\n Release",i),xlab='Lines of Code',ylab='Total Num of Days')
  title(paste("Plot for 'Defect Age' in release",i), outer=TRUE)
  input = readline(paste('Press Enter to view "Dev Hours" Plot for release',i))
  plot(release$numActive,release$Num.eff.dev.hours,main=paste0("Eff. Dev Hours  Vs.  Number of times Active\n Release",i),xlab='Number of times Active',ylab='Eff. Dev Hours')
  plot(release$numDaysActive,release$Num.eff.dev.hours,main=paste0("Eff. Dev Hours  Vs.  Number of days Active\n Release",i),xlab='Number of days Active',ylab='Eff. Dev Hours')
  plot(release$numReopened,release$Num.eff.dev.hours,main=paste0("Eff. Dev Hours  Vs.  Number of times Reopened\n Release",i),xlab='Number of times Reopened',ylab='Eff. Dev Hours')
  plot(release$LOC,release$Num.eff.dev.hours,main=paste0("Eff. Dev Hours  Vs.  Lines of Code\n Release",i),xlab='Lines of Code',ylab='Eff. Dev Hours')
  title(paste("Plot for 'Dev Hours' in release",i), outer=TRUE)
  input = readline(paste('Press Enter to view "Testing Hours" Plot for release',i))
  plot(release$numActive,release$Num.eff.testing.hours,main=paste0("Eff. Testing Hours  Vs.  Number of times Active\n Release",i),xlab='Number of times Active',ylab='Eff. Testing Hours')
  plot(release$numDaysActive,release$Num.eff.testing.hours,main=paste0("Eff. Testing Hours  Vs.  Number of days Active\n Release",i),xlab='Number of days Active',ylab='Eff. Testing Hours')
  plot(release$numReopened,release$Num.eff.testing.hours,main=paste0("Eff. Testing Hours  Vs.  Number of times Reopened\n Release",i),xlab='Number of times Reopened',ylab='Eff. Testing Hours')
  plot(release$LOC,release$Num.eff.testing.hours,main=paste0("Eff. Testing Hours  Vs.  Lines of Code\n Release",i),xlab='Lines of Code',ylab='Eff. Testing Hours')
  title(paste("Plot for 'Test Hours' in release",i), outer=TRUE)
}

#Shrinking the 30 releases
output_dataset<-data.frame(Rel_Num=double(),Num_Active=integer(),Num_Days_Active=integer(),Num_Reop=integer(),Tot_LOC=integer(),Tot_Days=double(),Tot_Dev_Hrs=double(),Tot_Test_Hrs=double(),Num_Sev_High=integer(),Num_Sev_Med=integer(),Num_Sev_Low=integer());
for (i in 1:30)
{
  release<-get(paste0("release",i))
  x<-data.frame(sum(release$numDaysActive),sum(release$numActive),sum(release$numReopened),sum(release$LOC),sum(release$Total.num.days),sum(release$Num.eff.dev.hours),sum(release$Num.eff.testing.hours),nrow(release[release$Severity=='High',]),nrow(release[release$Severity=='Medium',]),nrow(release[release$Severity=='Low',]),nrow(release[release$Priority=='High',]),nrow(release[release$Priority=='Medium',]),nrow(release[release$Priority=='Low',]))
  x<-cbind("Release_num"=i,x)
  names(x)<-c("Release_num","NumActive","NumDaysActive","NumReopened","Tot_LOC","Tot_Days","Tot_Dev_Hrs","Tot_Test_Hrs","Num_Sev_High","Num_Sev_Med","Num_Sev_Low","Num_Priot_High","Num_Priot_Med","Num_Priot_Low")
  output_dataset<-rbind(output_dataset,x)
}

# Shrinked file graph
input = readline('Press Enter to view "Total Number of Days" Trend analysis among all the releases')
plot(output_dataset$NumActive,output_dataset$Tot_Days,main="Total Num of Days  Vs.  Number of times Active",xlab='Number of times Active',ylab='Total Num of Days')
plot(output_dataset$NumDaysActive,output_dataset$Tot_Days,main="Total Num of Days  Vs.  Number of days Active",xlab='Number of days Active',ylab='Total Num of Days')
plot(output_dataset$NumReopened,output_dataset$Tot_Days,main="Total Num of Days  Vs.  Number of times Reopened",xlab='Number of times Reopened',ylab='Total Num of Days')
plot(output_dataset$Tot_LOC,output_dataset$Tot_Days,main="Total Num of Days  Vs. Total Lines of Code",xlab='Total Lines of Code',ylab='Total Num of Days')
input = readline('Press Enter to view "Total Dev Hours" Trend analysis among all the releases')
plot(output_dataset$NumActive,output_dataset$Tot_Dev_Hrs,main="Eff. Dev Hours  Vs.  Number of times Active",xlab='Number of times Active',ylab='Eff. Dev Hours')
plot(output_dataset$NumDaysActive,output_dataset$Tot_Dev_Hrs,main="Eff. Dev Hours  Vs.  Number of days Active",xlab='Number of days Active',ylab='Eff. Dev Hours')
plot(output_dataset$NumReopened,output_dataset$Tot_Dev_Hrs,main="Eff. Dev Hours  Vs.  Number of times Reopened",xlab='Number of times Reopened',ylab='Eff. Dev Hours')
plot(output_dataset$Tot_LOC,output_dataset$Tot_Dev_Hrs,main="Eff. Dev Hours  Vs.  Total Lines of Code",xlab='TotalLines of Code',ylab='Eff. Dev Hours')
input = readline('Press Enter to view "Total Testing Hours" Trend analysis among all the releases')
plot(output_dataset$NumActive,output_dataset$Tot_Test_Hrs,main="Eff. Testing Hours  Vs.  Number of times Active",xlab='Number of times Active',ylab='Eff. Testing Hours')
plot(output_dataset$NumDaysActive,output_dataset$Tot_Test_Hrs,main="Eff. Testing Hours  Vs.  Number of days Active",xlab='Number of days Active',ylab='Eff. Testing Hours')
plot(output_dataset$NumReopened,output_dataset$Tot_Test_Hrs,main="Eff. Testing Hours  Vs.  Number of times Reopened",xlab='Number of times Reopened',ylab='Eff. Testing Hours')
plot(output_dataset$Tot_LOC,output_dataset$Tot_Test_Hrs,main="Eff. Testing Hours  Vs.  Total Lines of Code",xlab='Total Lines of Code',ylab='Eff. Testing Hours')
input = readline('Press Enter to view "Number of High Severity Defects" Trend analysis among all the releases')
plot(output_dataset$NumActive,output_dataset$Num_Sev_High,main="Number of High severity defects  Vs.  Number of times Active",xlab='Number of times Active',ylab='Number of High Sev defects')
plot(output_dataset$NumDaysActive,output_dataset$Num_Sev_High,main="Number of High severity defects  Vs.  Number of days Active",xlab='Number of days Active',ylab='Number of High Sev defects')
plot(output_dataset$NumReopened,output_dataset$Num_Sev_High,main="Number of High severity defects  Vs.  Number of times Reopened",xlab='Number of times Reopened',ylab='Number of High Sev defects')
plot(output_dataset$Tot_LOC,output_dataset$Num_Sev_High,main="Number of High severity defects  Vs.  Total Lines of Code",xlab='Total Lines of Code',ylab='Number of High Sev defects')
input = readline('Press Enter to view "Number of Medium Severity Defects" Trend analysis among all the releases')
plot(output_dataset$NumActive,output_dataset$Num_Sev_Med,main="Number of Medium severity defects  Vs.  Number of times Active",xlab='Number of times Active',ylab='Number of Medium Sev defects')
plot(output_dataset$NumDaysActive,output_dataset$Num_Sev_Med,main="Number of Medium severity defects  Vs.  Number of days Active",xlab='Number of days Active',ylab='Number of Medium Sev defects')
plot(output_dataset$NumReopened,output_dataset$Num_Sev_Med,main="Number of Medium severity defects  Vs.  Number of times Reopened",xlab='Number of times Reopened',ylab='Number of Medium Sev defects')
plot(output_dataset$Tot_LOC,output_dataset$Num_Sev_Med,main="Number of Medium severity defects  Vs.  Total Lines of Code",xlab='Total Lines of Code',ylab='Number of Medium Sev defects')
input = readline('Press Enter to view "Number of Low Severity Defects" Trend analysis for all the releases')
plot(output_dataset$NumActive,output_dataset$Num_Sev_Low,main="Number of Low severity defects  Vs.  Number of times Active",xlab='Number of times Active',ylab='Number of Low Sev defects')
plot(output_dataset$NumDaysActive,output_dataset$Num_Sev_Low,main="Number of Low severity defects  Vs.  Number of days Active",xlab='Number of days Active',ylab='Number of Low Sev defects')
plot(output_dataset$NumReopened,output_dataset$Num_Sev_Low,main="Number of Low severity defects  Vs.  Number of times Reopened",xlab='Number of times Reopened',ylab='Number of Low Sev defects')
plot(output_dataset$Tot_LOC,output_dataset$Num_Sev_Low,main="Number of Low severity defects  Vs.  Total Lines of Code",xlab='Total Lines of Code',ylab='Number of Low Sev defects')
input = readline('Press Enter to view "Number of High Priority Defects" Trend analysis among all the releases')
plot(output_dataset$NumActive,output_dataset$Num_Priot_High,main="Number of High priority defects  Vs.  Number of times Active",xlab='Number of times Active',ylab='Number of High Prior defects')
plot(output_dataset$NumDaysActive,output_dataset$Num_Priot_High,main="Number of High priority defects  Vs.  Number of days Active",xlab='Number of days Active',ylab='Number of High Prior defects')
plot(output_dataset$NumReopened,output_dataset$Num_Priot_High,main="Number of High priority defects  Vs.  Number of times Reopened",xlab='Number of times Reopened',ylab='Number of High Prior defects')
plot(output_dataset$Tot_LOC,output_dataset$Num_Priot_High,main="Number of High priority defects  Vs.  Total Lines of Code",xlab='Total Lines of Code',ylab='Number of High Prior defects')
input = readline('Press Enter to view "Number of Medium Priority Defects" Trend analysis among all the releases')
plot(output_dataset$NumActive,output_dataset$Num_Priot_Med,main="Number of Medium priority defects  Vs.  Number of times Active",xlab='Number of times Active',ylab='Number of Medium Prior defects')
plot(output_dataset$NumDaysActive,output_dataset$Num_Priot_Med,main="Number of Medium priority defects  Vs.  Number of days Active",xlab='Number of days Active',ylab='Number of Medium Prior defects')
plot(output_dataset$NumReopened,output_dataset$Num_Priot_Med,main="Number of Medium priority defects  Vs.  Number of times Reopened",xlab='Number of times Reopened',ylab='Number of Medium Prior defects')
plot(output_dataset$Tot_LOC,output_dataset$Num_Priot_Med,main="Number of Medium priority defects  Vs.  Total Lines of Code",xlab='Total Lines of Code',ylab='Number of Medium Prior defects')
input = readline('Press Enter to view "Number of Low Priority Defects" Trend analysis for all the releases')
plot(output_dataset$NumActive,output_dataset$Num_Priot_Low,main="Number of Low priority defects  Vs.  Number of times Active",xlab='Number of times Active',ylab='Number of Low Prior defects')
plot(output_dataset$NumDaysActive,output_dataset$Num_Priot_Low,main="Number of Low priority defects  Vs.  Number of days Active",xlab='Number of days Active',ylab='Number of Low Prior defects')
plot(output_dataset$NumReopened,output_dataset$Num_Priot_Low,main="Number of Low priority defects  Vs.  Number of times Reopened",xlab='Number of times Reopened',ylab='Number of Low Prior defects')
plot(output_dataset$Tot_LOC,output_dataset$Num_Priot_Low,main="Number of Low priority defects  Vs.  Total Lines of Code",xlab='Total Lines of Code',ylab='Number of Low Prior defects')

output_model_TotDays<-lm(Tot_Days ~ NumActive+NumReopened+NumDaysActive+Tot_LOC,data = output_dataset)
output_model_DevHrs<-lm(Tot_Dev_Hrs ~ NumActive+NumReopened+NumDaysActive+Tot_LOC,data = output_dataset)
output_model_testHrs<-lm(Tot_Test_Hrs ~ NumActive+NumReopened+NumDaysActive+Tot_LOC,data = output_dataset)
output_model_svr_high_model<-lm(Num_Sev_High ~ NumActive+NumReopened+NumDaysActive+Tot_LOC,data = output_dataset)
output_model_svr_medium_model<-lm(Num_Sev_Med ~ NumActive+NumReopened+NumDaysActive+Tot_LOC,data = output_dataset)
output_model_svr_low_model<-lm(Num_Sev_Low ~ NumActive+NumReopened+NumDaysActive+Tot_LOC,data = output_dataset)
output_model_priot_high_model<-lm(Num_Priot_High ~ NumActive+NumReopened+NumDaysActive+Tot_LOC,data = output_dataset)
output_model_priot_medium_model<-lm(Num_Priot_Med ~ NumActive+NumReopened+NumDaysActive+Tot_LOC,data = output_dataset)
output_model_priot_low_model<-lm(Num_Priot_Low ~ NumActive+NumReopened+NumDaysActive+Tot_LOC,data = output_dataset)

input = readline('***********************Total Number of days Prediction for future release based on input Features************************')
summary(output_model_TotDays)
plot(output_model_TotDays)
input = readline('***********************Total Eff Dev Hours Prediction for future release based on input Features*************************')
summary(output_model_DevHrs)
plot(output_model_DevHrs)
input = readline('***********************Total Eff Testing Hours Prediction for future release based on input Features***********************')
summary(output_model_testHrs)
plot(output_model_testHrs)
input = readline('***********************Total Number of High Severity Defects Prediction for future release based on input Features***********************')
summary(output_model_svr_high_model)
plot(output_model_svr_high_model)
input = readline('***********************Total Number of Medium Severity Defects Prediction for future release based on input Features***********************')
summary(output_model_svr_medium_model)
plot(output_model_svr_medium_model)
input = readline('***********************Total Number of Low Severity Defects Prediction for future release based on input Features***********************')
summary(output_model_svr_low_model)
plot(output_model_svr_low_model)
input = readline('***********************Total Number of High Priority Defects Prediction for future release based on input Features***********************')
summary(output_model_priot_high_model)
plot(output_model_priot_high_model)
input = readline('***********************Total Number of Medium Priority Defects Prediction for future release based on input Features***********************')
summary(output_model_priot_medium_model)
plot(output_model_priot_medium_model)
input = readline('***********************Total Number of Low Priority Defects Prediction for future release based on input Features***********************')
summary(output_model_priot_low_model)
plot(output_model_priot_low_model)